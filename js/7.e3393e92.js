(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{6301:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"D_Cart"}},[r("q-page-container",{staticClass:"container"},[r("q-stepper",{ref:"stepper",staticClass:"q-mb-xl",attrs:{animated:"","alternative-labels":"","header-class":"text-bold","done-color":"orange","active-color":"purple","inactive-color":"secondary"},scopedSlots:e._u([{key:"navigation",fn:function(){return[r("q-stepper-navigation",[0===e.donate.length&&e.step<2?r("q-btn",{attrs:{disable:"",rounded:"",outline:"",label:"下一頁"}}):e._e(),e.step<2&&0!==e.donate.length?r("q-btn",{attrs:{rounded:"",outline:"",label:"下一頁"},on:{click:function(t){return e.next()}}}):e._e(),2===e.step?r("q-btn",{staticClass:"q-mr-sm",attrs:{rounded:"",filled:"",label:"上一頁"},on:{click:function(t){return e.$refs.stepper.previous()}}}):e._e(),2===e.step?r("q-btn",{attrs:{rounded:"",outline:"",label:"送出"},on:{click:function(t){return e.submit()}}}):e._e(),3===e.step?r("q-btn",{attrs:{rounded:"",outline:"",label:"完成",to:"/Member"}}):e._e()],1)]},proxy:!0}]),model:{value:e.step,callback:function(t){e.step=t},expression:"step"}},[r("q-step",{attrs:{name:1,title:"我的捐贈",icon:"fa fa-shopping-basket",done:e.step>1}},[r("div",{staticClass:"order01 q-pb-md"},[e._v("捐贈物資")]),r("q-list",{attrs:{bordered:""}},[0===e.donate.length?r("q-item",{staticClass:"text-center"},[r("div",{staticClass:"w-100 q-ma-auto q-py-xl"},[r("p",{staticClass:"q-mb-md"},[e._v("您的捐贈籃目前是空的")]),r("q-btn",{attrs:{to:"/Donate",label:"＜ 返回物資捐贈頁面",outline:"",rounded:""}})],1)]):e._l(e.donate,(function(t,a){return r("q-item",{key:a,staticClass:"row",attrs:{clickable:""}},[r("div",{staticClass:"row w-90 justify-around col-12 col-md "},[r("q-item-section",{staticClass:"col-6 col-md-4"},[r("q-img",{attrs:{src:t.src}})],1),r("q-item-section",{staticClass:"col-6 col-md-8 "},[r("q-item-label",{staticClass:"q-pl-sm"},[e._v(e._s(t.item))]),r("q-item-label",{staticClass:"q-pl-sm",attrs:{lines:2,caption:""}},[e._v(e._s(t.requester))])],1)],1),r("div",{staticClass:"row w-90 justify-evenly col-12 col-md "},[r("q-item-section",{staticClass:"col-3 col-md-4"},[r("div",{staticClass:"q-mx-auto"},[e._v(e._s(t.spec))])]),r("q-item-section",{staticClass:"col-5 col-md-4"},[r("q-field",{staticClass:"q-mx-auto ",scopedSlots:e._u([{key:"append",fn:function(){return[r("q-btn",{staticClass:"count_btn",attrs:{flat:"",round:"",dense:"",icon:"remove",disable:t.count<2},on:{click:function(r){return r.stopPropagation(),e.minusBasket(t._id)}}}),r("span",{staticClass:"count"},[e._v(e._s(t.count))]),r("q-btn",{staticClass:"count_btn",attrs:{flat:"",round:"",dense:"",icon:"add"},on:{click:function(r){return r.stopPropagation(),e.plusBasket(t._id)}}})]},proxy:!0}],null,!0)})],1),r("q-item-section",{staticClass:"col-2 col-md-4"},[r("q-btn",{staticClass:"del q-mx-auto",attrs:{outline:"",rounded:""},on:{click:function(t){return e.delBasket(a)}}},[r("i",{staticClass:"fas fa-trash-alt"})])],1)],1)])}))],2)],1),r("q-step",{attrs:{name:2,title:"填寫資料",icon:"fas fa-user-edit",done:e.step>2}},[r("div",{staticClass:"order01 q-pb-md"},[e._v("聯絡資料")]),r("form",[r("q-card-section",{staticClass:"row q-py-md"},[r("div",{staticClass:"col-12 col-md-6 q-gutter-y-md"},[r("q-input",{staticClass:"q-pb-none",attrs:{readonly:!0===e.order.checkbox,rounded:"",outlined:"",required:"",type:"text",label:"捐贈者姓名 *",rules:[function(e){return e.length>0}]},model:{value:e.order.name,callback:function(t){e.$set(e.order,"name",t)},expression:"order.name"}})],1),r("div",{staticClass:"col-12 col-md-6 q-gutter-y-md"},[r("q-input",{staticClass:"q-pb-none",attrs:{readonly:!0===e.order.checkbox,rounded:"",outlined:"",required:"",type:"text",label:"捐贈者電話 *",rules:[function(e){return e.length>0}]},model:{value:e.order.phoneNum,callback:function(t){e.$set(e.order,"phoneNum",t)},expression:"order.phoneNum"}})],1),r("div",{staticClass:"col-12 q-gutter-y-md"},[r("q-input",{staticClass:"q-pb-none",attrs:{readonly:!0===e.order.checkbox,rounded:"",outlined:"",required:"",type:"text",label:"電子信箱 *",rules:[function(e){return e.length>0}]},model:{value:e.order.email,callback:function(t){e.$set(e.order,"email",t)},expression:"order.email"}})],1),r("div",{staticClass:"col-12 q-gutter-y-md"},[r("q-input",{staticClass:"q-pb-none",attrs:{readonly:!0===e.order.checkbox,rounded:"",outlined:"",required:"",type:"text",label:"聯絡地址 *",rules:[function(e){return e.length>0}]},model:{value:e.order.address,callback:function(t){e.$set(e.order,"address",t)},expression:"order.address"}})],1),r("div",{staticClass:"col-12 q-gutter-y-sm q-pl-md"},[r("q-option-group",{attrs:{inline:"",options:e.radios},model:{value:e.order.send,callback:function(t){e.$set(e.order,"send",t)},expression:"order.send"}})],1),r("div",{staticClass:"col-12 q-gutter-y-md q-mb-sm"},[r("q-input",{attrs:{rounded:"",outlined:"",required:"",type:"text",label:"捐贈備註 *"},model:{value:e.order.note,callback:function(t){e.$set(e.order,"note",t)},expression:"order.note"}})],1),r("div",{staticClass:"col-12 "},[r("q-checkbox",{attrs:{label:"同會員資料"},model:{value:e.order.checkbox,callback:function(t){e.$set(e.order,"checkbox",t)},expression:"order.checkbox"}})],1)])],1)]),r("q-step",{attrs:{name:3,title:"捐贈確認",icon:"fas fa-hand-holding-heart"}},[r("div",{staticClass:"order03 q-pb-md"},[e._v("捐贈訂單成立")]),r("q-list",{attrs:{bordered:""}},[r("q-item",{staticClass:"q-pa-md"},[r("div",{staticClass:"orderLine col-12 flex justify-between items-center q-px-sm"},[e.member.orderDonate.length>0&&e.member.orderDonate[e.member.orderDonate.length-1]?r("div",{staticClass:"ordNum"},[e._v("\n                訂單編號 \n                "),r("b",[e._v(e._s(e.member.orderDonate[e.member.orderDonate.length-1]._id))])]):e._e(),e.member.orderDonate.length>0&&e.member.orderDonate[e.member.orderDonate.length-1]?r("div",{staticClass:"date"},[e._v("\n                "+e._s(e.member.orderDonate[e.member.orderDonate.length-1].date.substr(0,10))+"\n              ")]):e._e()]),r("div",{staticClass:"col-12 q-pa-sm"},[r("div",{staticClass:"col-12 order03 q-pb-sm"},[e._v("聯絡資訊")]),e.member.orderDonate.length>0&&e.member.orderDonate[e.member.orderDonate.length-1]?r("div",{staticClass:"col-12 detail"},[e._v("\n                "+e._s("姓名："+e.member.orderDonate[e.member.orderDonate.length-1].name)+"\n              ")]):e._e(),e.member.orderDonate.length>0&&e.member.orderDonate[e.member.orderDonate.length-1]?r("div",{staticClass:"col-12 detail"},[e._v("\n                "+e._s("電話："+e.member.orderDonate[e.member.orderDonate.length-1].phoneNum)+"\n              ")]):e._e(),e.member.orderDonate.length>0&&e.member.orderDonate[e.member.orderDonate.length-1]?r("div",{staticClass:"col-12 detail"},[e._v("\n                "+e._s("電子信箱："+e.member.orderDonate[e.member.orderDonate.length-1].email)+"\n              ")]):e._e(),e.member.orderDonate.length>0&&e.member.orderDonate[e.member.orderDonate.length-1]?r("div",{staticClass:"col-12 detail"},[e._v("\n                "+e._s("地址："+e.member.orderDonate[e.member.orderDonate.length-1].address)+"\n              ")]):e._e()]),r("q-separator",{staticClass:"q-my-sm",attrs:{spaced:""}}),r("div",{staticClass:"col-12 q-pa-sm"},[r("div",{staticClass:"col-12 order03 q-pb-sm"},[e._v("捐贈品項")]),r("div",{staticClass:"col-12"},[e._l(e.member.orderDonate.length>0?e.member.orderDonate[e.member.orderDonate.length-1].donation:0,(function(t,a){return r("div",{key:a},[r("div",{staticClass:"col-12 detailDonation"},[e._v("\n                    "+e._s("捐贈物品："+t.d_id.item)+"\n                  ")]),r("div",{staticClass:"col-12 detailDonation"},[e._v("\n                    "+e._s("捐贈數量："+t.quantity)+"\n                  ")]),r("q-separator",{staticClass:"q-my-sm"})],1)})),e.member.orderDonate.length>0&&e.member.orderDonate[e.member.orderDonate.length-1]?r("div",{staticClass:"col-12 detail"},[e._v("\n                  "+e._s("寄送方式："+e.member.orderDonate[e.member.orderDonate.length-1].send)+"\n                ")]):e._e(),e.member.orderDonate.length>0&&e.member.orderDonate[e.member.orderDonate.length-1]?r("div",{staticClass:"col-12 detail"},[e._v("\n                  "+e._s("捐贈備註："+e.member.orderDonate[e.member.orderDonate.length-1].note)+"\n                ")]):e._e()],2)])],1)],1)],1)],1)],1)],1)},s=[],o={name:"PageD_Cart",data(){return{step:1,fields:[{key:"item",label:"物資名稱"},{key:"requester",label:"需求單位"},{key:"spec",label:"物資規格"},{key:"amount",label:"捐贈數量"},{key:"action",label:" "}],orderDonate:[],order:{id:"",date:new Date,name:"",phoneNum:"",email:"",address:"",send:"郵寄",note:"",checkbox:!1,donation:[{d_id:"",quantity:""}]},radios:[{label:"郵寄",value:"郵寄"},{label:"宅配",value:"宅配"},{label:"面交",value:"面交"},{label:"其他（請於備註欄位說明）",value:"其他"}]}},watch:{order:{deep:!0,handler(){this.order.checkbox&&(this.order.name=this.member.name,this.order.phoneNum=this.member.phoneNum,this.order.email=this.member.email,this.order.address=this.member.address)}}},computed:{donate(){return this.$store.getters.donate},member(){return this.$store.state.member},donateList(){return this.$store.getters.cart.products}},methods:{delBasket(e){this.$store.commit("delBasket",e)},minusBasket(e){this.$store.commit("minusBasket",e)},plusBasket(e){this.$store.commit("plusBasket",e)},submit(){0===this.member.id.length?this.$q.notify({color:"red-6",icon:"fas fa-exclamation-circle",message:"請登入會員"}).then((()=>{this.$router.push("/login")})):(this.axios.post("https://mumuweb.herokuapp.com/members/member/order/"+this.member.id,this.order).then((e=>{e.data.success?this.$store.commit("addorder",e.data.result):this.$q.notify({color:"red-6",icon:"fas fa-exclamation-circle",message:e.data.message})})).catch((e=>{this.$q.notify({color:"red-6",icon:"fas fa-exclamation-circle",message:e.response.data.message})})),this.step++)},next(){if(1===this.step)for(const e in this.donate)this.order.donation[e]={d_id:this.donate[e]._id,quantity:this.donate[e].count};this.step++}}},n=o,l=r("2877"),i=r("09e3"),d=r("f531"),c=r("87fe"),m=r("1c1c"),u=r("66e5"),b=r("9c40"),p=r("4074"),h=r("068f"),q=r("0170"),v=r("8572"),f=r("a370"),_=r("27f9"),g=r("9f0a"),C=r("8f8e"),D=r("eb85"),k=r("b19c"),x=r("eebe"),y=r.n(x),$=Object(l["a"])(n,a,s,!1,null,null,null);t["default"]=$.exports;y()($,"components",{QPageContainer:i["a"],QStepper:d["a"],QStep:c["a"],QList:m["a"],QItem:u["a"],QBtn:b["a"],QItemSection:p["a"],QImg:h["a"],QItemLabel:q["a"],QField:v["a"],QCardSection:f["a"],QInput:_["a"],QOptionGroup:g["a"],QCheckbox:C["a"],QSeparator:D["a"],QStepperNavigation:k["a"]})}}]);